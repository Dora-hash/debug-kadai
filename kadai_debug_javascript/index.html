<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>タイマーアプリ</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=RQ0Ou-znhdXwEFQLZbg_-iqHoncQbSU027wp37CvKTq8I6DdRniOTTxr3-Cz7q_cqlj21CxpTx7R2QzfSb7aB5eU40NqGk4FF3o59xGEd3an0uFjYaISIer1feJ-0F-Cs814GBpyQCD_yJyOYeyek502-Yqk0RmHMxxclE_CwUvh6tCQPOqIIhsOMASPdBkv0YmqYFfdSmBpG80KvYycjgrMQXv9NwtkgZUGQEXhOgUr93NNhSacOMzzAZvz7TrLLj5HhjIkiuZV_J-BTbwH5ZDijybQ8O-IDhV6PD1H5QCahboophE-0I7FEpg3o-FyNoCtuQPAm4LoNhxslOKbKZjPgloxqMbyv_DX7vEKO1VFAvnKyMeqs11WaUHuZuEGeHzbSYTaFxF5Xwe5nHSi9Q-b4Ke6mm5leJWKnA1GdVnZ_YW18QBwiaKFV25olImDTaKXLcF_FLUbK145OjhzPC7WNKlBXcAUL0up8YEs5F2U9L-WFEX8XdoRXvJGy4tpd4w_prWypNBZUDZ0CmX68rBiH07oLSgB0HYTQgm9w4fK5QSTz61OHm_gNeR_LQBieFnONuCSwlvJwbDue7XBOd-SPQqndhKkVivdcejedEF9XTmYzYgdYb-hW6hRfb3u0giJLug1e78_oDnNuXly0nu3EhHQDxgpzZwCe2d-PngndU7RHrqzBf4Ccx--4z6B3ltJM2rUyNBGHiQzefs0ZJLPMHqIPIBz5g0_StVA-ZkvMgZgs18UHGaEr2Bn5iS4m2bGNQh60xwM5E91erD4EJwFxVV7oDUp_azIV3Uh1_m4WeXKMjcZHi8M60ULHm3k-Tt6DyVxGw7nyC93DkHrIvHXYgyzGW0lNbv55p-9JkRvWvaQFR0732Ewoay-Rqn-fLdFRorZSLEUq6AUefi-xuAfTC6QceBDhppx5wkEdh_ZWkuGJcwgodLXbdvepiGx5FHkJ9l2xY9h-6VhIe4foVgOaSc3ioIE6eCumrZDr2_d9iJOSS5SK6LOHDYYsK8zJ0FV5VaRt8v_1_vl-JhwtRWp2KGxI4h-YBiD7Y2vSliMqVSPpzOSIgSDNb0KJprmfSMPsbmnA8ifCUvmO-FAr-mfgmTI2ir36dSFaz1848z9AgdxRKXd3U2ONiuLfwc-Ad6NoavY7Vefs5XdErQmqdu4DkiF_zdddqqm3ZojxvAqX0oX8KM0bIAHbfiRn3EOpwLGM1pTPZ4k6tdcnUqUW7YBs2LlSwpjbtU-BMfAsB5ppxBqSzaSBpKKbBh0YD8B44HOomeemYhuAtt3tUkYVS70ydCJ8HdPAYVSLnLteCWu-mXkhNKXMWOlhjTcaQzKIIsSmCIn0Mjjg6cYhJfMQRuUk8GjN3F-DqiFygqO1_-adnkdWDVjHc7Mft9vneY1zzGOfCCF99mCfWlqvp-zWDW5eMrb04Dn3zNUZRoRjITF__oHt5xeQSZM5NvRdYIGQnWf3nVuq5VBrgcxJzcAYc0POo3kySmXavxAnXg1j5RjaNxd9OERjpU-U3KjFyuAQN6nY7D6eMxIpLiTIDchWbsGZBHJOHCr-G__kzQLtNDY87tnDQPcbqKxcBPO0Rk18iHWCSk1OO2xEE4fC2NxpYwPM2-NyZN6apL4UTwBtO0ZaARqVitYgSZxcnF7a2K5wPJ8VUYYnAXmaamtAWLzL9M31Y92KF8NNGstX_X9nrH4oIpOLJug6qtHP3RqZOPc9AaMcf3KxytNSGubpH9L9w" charset="UTF-8"></script><link rel="stylesheet" crossorigin="anonymous" href="https://gc.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly9kb2MtMHMtOGstZG9jcy5nb29nbGV1c2VyY29udGVudC5jb20vZG9jcy9zZWN1cmVzYy9xcGZsMTFlNDJtYjBudXVtbHU5Y3Rna2htanN0MnVqay9nbjdxNjA4cHVhNnI4YWxianZ0OXIwY29zM3BwOXB2aS8xNzAxNDg2Njc1MDAwLzE3ODQxODI5MzYyOTM5ODMzNzIzLzE2MzQyMTIyNTgwNjEyOTY0MDYwLzFZN2VqbGhYRmZhTmhBd2FvaEYxX2lLWENIR3Z4VHRVXz9lPWRvd25sb2FkJmF4PUFFcWdMeGt3MlFNS1pYRWR3VXNHanlQUi1lSmotU3JhbWt5bF84ZnhVQktMRnBmLUM1czAxOGE5cW96alp3YXQzUV9uZGxxTFp2YjNWT2RGZ0hJLXVIZWhNcVpXc0NGVzJoZ3lvemUzTndUS2Z6RWI1Z09FTjJTNlFMSGV6aE1pREFFdjdKWE4yMzhUaF9MMWNDclNUYTA4b3I2SjNMVVZ3aW16TkF3NmNQb3Rja1MtYTQzQnYtMGlfQ0lxOUJ3SXdpNTdJdGd5ZGd5SFhWR0xWdGJWajVVTGxzcDFtQUJ2SWY0VTZWZGxSLTViT0Ztall1SmtlZ0tLSzI0UDdXRUJmRGtNVkl5NjJiQzJiQkJuWHJ6T190Zm9RYzdzNENabkU0SkhZU3pOQkVUcVlmb19WMEdWYm5lMTFJdkpsTm9zSV9NczNQRVhmeVpJRzJjZ3N1NndObW50MUhxMzZRMUFrSXFBV0dYSnJwSUFWQ1R4ODdjU2hjNnM0ZHd5QjY3VHEyTXp6dGhJOGRIOE5rUllFejJ4VXc1Y0JlTDFyV3JhODIwaXpGZlU1eUlRTmU0bUpUcU5yZTV6eDlabVpPZXFUSkJtX2tsbmNNMlplTktnbmMwZFZKdkpoOE1jajlvcmt2ODhIUFJhZWlRZ3pSWEs3VXpZbkszQzh1TG5xeEdwRHN0ZlkyWURva3o2WUNyM0k4Z205ekdhUzF2ZWFlNm14VG5oM2pOMzcwYjhZY1JOR0xhYmpuc1c5Nmh6bDVuYkI1cEs5WTJyV0owWVJ5eTFXcjhIT0k0a3VMelhzZy1ZblFOR1lOOTZSeXFyTmtnTGppWW5aVDBwR3ZFeUw0dldmWUVLVl9INFVHNlpkcFVfNXlYVXlaSkdCV1dSMVBIbUJ4b2hCX3NvWmNld2xTRUl4WkRaZVJNTFNacFdFYThBeFRLd05tQURfcC10cTRKOHg2SmNiRGQzcGg2dWduZmxLa3FIckoxRVRpYTBQZ0ZCUnJSeHFUSVFkWEFVV0F5UGg5dGpyWXJaZUY4aWJ3Nm1KZk85UWFDbWJWLXpJN21INHZSUmFKenlmZDVLTmJNVHR5eXBfUVpPaWNza1B3T0tWNnhNNFB0MEs5a2pwOGJMRnJmODhFVjVZT1g4ZERXQmtIREx6UGRyTFRPVm94d0x5VmhVVHB5WVF1VjRkRHNfSm9YbGRWVFRzbDNxR1puM0NGNFImdXVpZD1kZTlmZmQ2My1kYTEzLTRkYTAtYThlMC0zNDU0NTFlMmU0YjQmYXV0aHVzZXI9MCZub25jZT02ZXJkbjd1ZTFxZmt1JnVzZXI9MTYzNDIxMjI1ODA2MTI5NjQwNjAmaGFzaD0yZmhkbnExYWhidGxwNWFiZmk4aHB1NjdncDdvYXY1Zw"/><style>
        .hidden {
            display: none;
        }
    </style>
</head>

<body class="container my-4 d-flex justify-content-center">
    <div class="text-center col-12 col-md-6">

        <!-- タイマー表示部分 -->
        <div>
            <span id="timer" class="display-4">00:00</span>
        </div>

        <!-- 入力フォーム -->
        <div id="inputForm" class="mt-3 hidden">
            <div class="row justify-content-center">
                <div class="col-6 d-flex align-items-center">
                    分：<input type="number" id="minutes" class="form-control" oninput="updateTimer()" min="0">
                </div>
                <div class="col-6 d-flex align-items-center">
                    秒：<input type="number" id="seconds" class="form-control" oninput="updateTimer()" min="0">
                </div>
            </div>
            <!-- エラーメッセージ -->
            <span id="error" class="hidden text-danger"></span>
        </div>

        <!-- ボタン -->
        <div class="mt-3">
            <button id="start" class="btn btn-primary mb-3 hidden w-100" onclick="startCountdown()">スタート</button>
            <div class="row justify-content-center">
                <div class="col-6">
                    <button id="pause" class="btn btn-info mb-3 hidden w-100" onclick="pauseCountdown()">一時停止</button>
                    <button id="resume" class="btn btn-info mb-3 hidden w-100" onclick="resumeCountdown()">再開</button>
                </div>
                <div class="col-6">
                    <button id="reset" class="btn btn-info mb-3 hidden w-100" onclick="resetCountdown()">リセット</i></button>
                </div>
            </div>
            <button id="setTime" class="btn btn-secondary mb-3 hidden w-100" onclick="setTimeMode()">設定</button>
            <button id="alertStop" class="btn btn-danger mt-5 hidden w-100 btn-lg rounded-pill" onclick="stopAlert()">アラート停止</button>
        </div>
    </div>
<script>
    let countdownInterval = false;
    let alertInterval = false;
    let isPaused = false;

        // 入力フォームの値をタイマーに表示する関数
        function updateTimer() {
            let minutes = document.getElementById('minutes').value || 0;
            let seconds = document.getElementById('seconds').value || 0;

            // 入力フォームの値をチェック
            if (minutes < 0 || seconds < 0) {
                document.getElementById('error').innerText = "マイナスは入力できません";
                document.getElementById('error').classList.remove('hidden');
                return;
            }

            document.getElementById('error').classList.add('hidden');
            document.getElementById('timer').innerText = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        // カウントダウンを開始する関数
        function startCountdown() {
            let minutes = document.getElementById('minutes').value || 0;
            let seconds = document.getElementById('seconds').value || 0;
            let timeLeft = (minutes * 60) + parseInt(seconds);
            setMode("progress");
            countdownInterval = setInterval(() => {
                if(!isPaused) {
                    timeLeft--;
                    if(timeLeft < 0) {
                        clearInterval(countdownInterval);
                        startAlert();
                    } else {
                        let m = Math.floor(timeLeft / 60);
                        let s = timeLeft % 60;
                        document.getElementById('timer').innerText = `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
                    }
                }
            }, 1000);
            console.log(isPaused);
        }

        // カウントダウンを一時停止する関数
        function pauseCountdown() {
            isPaused = true;
            setMode("paused");
            console.log(isPaused);
        }

        // カウントダウンを再開する関数
        function resumeCountdown() {
            isPaused = false;
            setMode("progress");
        }

        // カウントダウンをリセットする関数
        function resetCountdown() {
            clearInterval(countdownInterval);
            updateTimer();
            isPaused = false;
            setMode("restart");
        }

        // 時間設定モードに変更する関数
        function setTimeMode() {
            clearInterval(countdownInterval);
            setMode("setting");
        }

        // アラートを開始する関数
        function startAlert() {
            alertInterval = setInterval(() => {
                document.body.style.backgroundColor = document.body.style.backgroundColor === 'red' ? 'white' : 'red';
            }, 1000);
            document.getElementById('alertStop').classList.remove('hidden');
        }

        // アラートを停止する関数
        function stopAlert() {
            clearInterval(alertInterval);
            document.body.style.backgroundColor = 'white';
            document.getElementById('alertStop').classList.add('hidden');
        }

        // HTML要素の表示を制御する関数
        function setMode(mode) {
            const modes = {
                setting: ["start", "inputForm"],
                progress: ["pause", "reset", "setTime"],
                paused: ["resume", "reset", "setTime"],
                restart: ["start", "setTime"],
            };

            // すべてのボタンと入力フォームを非表示にする
            const elements = document.querySelectorAll('#inputForm, #start, #pause, #resume, #reset, #setTime');
            elements.forEach(elem => elem.classList.add('hidden'));

            // 指定されたモードの要素だけを表示する
            const ids = modes[mode];
            ids.forEach(id => document.getElementById(id).classList.remove('hidden'));
        }

        // 初期状態をセット
        setMode("setting");
    </script>
</body>
</html>
